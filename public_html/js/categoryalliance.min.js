window.Nico_CategoryAllianceController=function(){var e,d=function(){return{fetchByZoneId:function(a,b){jQuery.getJSON(e+"api/OxBannerService/getAdvertisementsAndLogImpression.jsonp?callback=?",{zone:a},b)}}}(),k=function(){return{fetchAdsListCallback:function(a){a.data&&b.setAdsData(a.data)},fetchTopAdCallback:function(a){a.data&&1===a.data.length&&b.setTopAd(a.data[0])}}}(),b=function(){var a=!1,b=!1,f,g,h,d=function(a,b){b.find("a").attr("href",e+"click?bannerid="+encodeURIComponent(a.bannerid)+
"&zoneid="+encodeURIComponent(a.zoneid));var c=b.find("img");0<c.size()&&(c.attr("src",e+"assets/images/"+a.filename),c.attr("alt",a.bannertext));b.find("span").text(a.bannertext);b.show()};return{setCategoryAllianceArea:function(l){f=jQuery(l);g=f.find("li");h=f.find(".jsCategoryAllianceTopAd");0<g.size()&&(a=!0);0<h.size()&&(b=!0)},hasAdsList:function(){return a},hasTopAd:function(){return b},setAdsData:function(a){var b=!1;jQuery(g).each(function(c){a[c]&&(d(a[c],jQuery(this)),b=!0)});b&&f.show()},
setTopAd:function(a){d(a,h)}}}();return{setAdsBaseUrl:function(a){e=a},setCategoryAllianceArea:function(a){b.setCategoryAllianceArea(a)},fetchAdsList:function(a){b.hasAdsList()&&d.fetchByZoneId(a.join(","),k.fetchAdsListCallback)},fetchTopAd:function(a){b.hasTopAd()&&d.fetchByZoneId(a,k.fetchTopAdCallback)}}}();
